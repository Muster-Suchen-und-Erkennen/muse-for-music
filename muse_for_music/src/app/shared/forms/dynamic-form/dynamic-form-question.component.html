<div class="pv2 flex items-center" [formGroup]="form" *ngIf="!nested && !question.readOnly" >
    <i [hidden]="!isValid" class="w2 tc mr1 f5 fa fa-check"></i>
    <i [hidden]="isValid" class="w2 tc mr1 f5 red fa fa-exclamation"></i>

    <div class="flex-grow flex flex-wrap">
    <label class="f4 ws-normal flex-grow" style="word-wrap: break-word" [attr.for]="question.key">
        {{question.label}}
    </label>

    <div class="pl1" >
        <div [ngSwitch]="question.controlType">

            <div *ngSwitchCase="'string'" class="w5 flex bb b--gray">
                <input class="input-reset w5 bn pa1" [formControlName]="question.key" [id]="question.key" [type]="question.type">
            </div>

            <textarea *ngSwitchCase="'text'" class="w5" [formControlName]="question.key" [id]="question.key"></textarea>

            <div *ngSwitchCase="'date'" class="w5 flex bb b--gray">
                <input class="input-reset w5 bn pa1" [formControlName]="question.key" [id]="question.key" [type]="question.type">
            </div>

            <m4m-number-input *ngSwitchCase="'number'" [formControlName]="question.key" [question]="question"></m4m-number-input>

            <div *ngSwitchCase="'boolean'" class="w5 flex">
                <input [formControlName]="question.key" [id]="question.key" [type]="question.type">
            </div>

            <div *ngSwitchCase="'dropdown'" class="w5 flex bb b--gray gray hover-black">
                <select [id]="question.key" class="input-reset w5 bn pa1 bg-white black" [formControlName]="question.key" #inputSelect>
                    <option *ngFor="let opt of question.options" [value]="opt">{{opt}}</option>
                </select>
                <div class="w2 flex justify-around items-center pointer link" style="margin-left: -2rem; pointer-events: none" (click)="inputSelect.click($event)"><i class="f4 fa fa-angle-down"></i></div>
            </div>

            <m4m-reference-chooser *ngSwitchCase="'reference'" [formControlName]="question.key" [question]="question"></m4m-reference-chooser>

            <m4m-taxonomy-select *ngSwitchCase="'taxonomy'" [formControlName]="question.key" [question]="question"></m4m-taxonomy-select>

        </div>

        <!--div class="f6">{{question.label}} is required</div-->
    </div>
</div>
</div>

<m4m-array-input [question]="question" [array]="form.controls[question.key]" *ngIf="question.controlType === 'array'"></m4m-array-input>
<div class="flex" *ngIf="question.controlType === 'object'" [formGroup]="form">
    <div class="bl bw2 mr2 ml2 b--gray">
        <div class="flex-grow" formGroupName="{{question.key}}">
            <div *ngFor="let qstn of question?.nestedQuestions" class="form-row">
                <df-question [question]="qstn" [form]="form.controls[question.key]" [nested]="false"></df-question>
            </div>
        </div>
    </div>
</div>
